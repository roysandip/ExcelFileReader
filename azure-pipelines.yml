trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

steps:
- task: Maven@3
  inputs:
    mavenPomFile: 'pom.xml'
    mavenOptions: '-Xmx1024m'
    javaHomeOption: 'JDKVersion'
    jdkVersionOption: '1.8'
    jdkArchitectureOption: 'x64'
    publishJUnitResults: true
    testResultsFiles: '**/surefire-reports/TEST-*.xml'
    codeCoverageTool: 'jaCoCo'
    #codeCoverageTool: 'Cobertura'
    #codeCoverageFailIfEmpty: true
    goals: 'package'
    sonarQubeRunAnalysis: true
    sqMavenPluginVersionChoice: 'latest'



#- task: SonarCloudPrepare@1
 # inputs:
  #  SonarCloud: 'my-sample-sonarcloud-conn'
   # organization: 'sandiproy'
    #scannerMode: 'Other'
    
#- task: SonarCloudPublish@1
 # inputs:
  #  pollingTimeoutSec: '300
  
  
- task: CopyFiles@2
  inputs:
    sourceFolder: '$(Agent.BuildDirectory)/s/target'
    contents: '*.jar' 
    targetFolder: '$(Build.ArtifactStagingDirectory)'
    #cleanTargetFolder: false # Optional
    #overWrite: false # Optional
    #flattenFolders: false # Optional
    #preserveTimestamp: false # Optional

# Publish build artifacts
# Publish build artifacts to Azure Pipelines or a Windows file share
- task: PublishBuildArtifacts@1
  inputs:
    pathtoPublish: '$(Build.ArtifactStagingDirectory)' 
    artifactName: 'drop' 
    publishLocation: 'Container' # Options: container, filePath
    #targetPath: # Required when publishLocation == FilePath
    #parallel: false # Optional
    #parallelCount: # Optional
    #fileCopyOptions: #Optional
    
  # Download build artifacts
# Download files that were saved as artifacts of a completed build
#- task: DownloadBuildArtifacts@0
 # inputs:
    #buildType: 'current' # Options: current, specific
    #project: # Required when buildType == Specific
    #pipeline: # Required when buildType == Specific
    #specificBuildWithTriggering: false # Optional
    #buildVersionToDownload: 'latest' # Required when buildType == Specific. Options: latest, latestFromBranch, specific
    #allowPartiallySucceededBuilds: false # Optional
    #branchName: 'refs/heads/master' # Required when buildType == Specific && BuildVersionToDownload == LatestFromBranch
    #buildId: # Required when buildType == Specific && BuildVersionToDownload == Specific
    #tags: # Optional
    #: 'single' # Choose whether to download a single artifact or all artifacts of a specific build. Options: single, specific
   # artifactName: 'drop' # Required when downloadType == Single
    #itemPattern: '**' # Optional
#downloadPath: '$(System.ArtifactsDirectory)' 
    #parallelizationLimit: '8' # Optional
